{% comment %}
  TOOLTIP COMPONENT (Shopify Liquid version)
  ------------------------------------------
  Accessible tooltip with fade/zoom animation and side positioning.

  Usage:
  {% render 'tooltip',
    text: 'Click to copy',
    position: 'top',
    delay: 0
  %}
{% endcomment %}

{% assign text = text | default: 'Tooltip' %}
{% assign position = position | default: 'top' %}
{% assign delay = delay | default: 0 %}
{% assign class = class | default: '' %}

<style>
  .tooltip-wrapper {
    position: relative;
    display: inline-block;
  }

  .tooltip-content {
    position: absolute;
    background-color: var(--tooltip-bg, #111);
    color: var(--tooltip-fg, #fff);
    font-size: 0.75rem;
    line-height: 1.2;
    padding: 0.375rem 0.625rem;
    border-radius: 0.375rem;
    white-space: nowrap;
    pointer-events: none;
    opacity: 0;
    transform: scale(0.95);
    transform-origin: center;
    transition:
      opacity 0.15s ease,
      transform 0.15s ease,
      visibility 0.15s ease;
    visibility: hidden;
    z-index: 50;
  }

  .tooltip-wrapper[data-visible="true"] .tooltip-content {
    opacity: 1;
    visibility: visible;
    transform: scale(1);
  }

  .tooltip-content[data-position="top"] {
    bottom: calc(100% + 0.4rem);
    left: 50%;
    transform: translateX(-50%) scale(0.95);
  }

  .tooltip-content[data-position="bottom"] {
    top: calc(100% + 0.4rem);
    left: 50%;
    transform: translateX(-50%) scale(0.95);
  }

  .tooltip-content[data-position="left"] {
    right: calc(100% + 0.4rem);
    top: 50%;
    transform: translateY(-50%) scale(0.95);
  }

  .tooltip-content[data-position="right"] {
    left: calc(100% + 0.4rem);
    top: 50%;
    transform: translateY(-50%) scale(0.95);
  }

  .tooltip-arrow {
    position: absolute;
    width: 0.5rem;
    height: 0.5rem;
    background-color: var(--tooltip-bg, #111);
    transform: rotate(45deg);
    z-index: 49;
  }

  .tooltip-content[data-position="top"] .tooltip-arrow {
    bottom: -0.25rem;
    left: 50%;
    transform: translateX(-50%) rotate(45deg);
  }

  .tooltip-content[data-position="bottom"] .tooltip-arrow {
    top: -0.25rem;
    left: 50%;
    transform: translateX(-50%) rotate(45deg);
  }

  .tooltip-content[data-position="left"] .tooltip-arrow {
    right: -0.25rem;
    top: 50%;
    transform: translateY(-50%) rotate(45deg);
  }

  .tooltip-content[data-position="right"] .tooltip-arrow {
    left: -0.25rem;
    top: 50%;
    transform: translateY(-50%) rotate(45deg);
  }

  @media (prefers-color-scheme: dark) {
    .tooltip-content {
      background-color: rgba(255, 255, 255, 0.9);
      color: #000;
    }
    .tooltip-arrow {
      background-color: rgba(255, 255, 255, 0.9);
    }
  }
</style>

<div class="tooltip-wrapper {{ class }}" data-slot="tooltip">
  <span
    class="tooltip-trigger"
    tabindex="0"
    role="button"
    aria-label="{{ text }}"
  >
    {{ trigger | default: 'Hover me' }}
  </span>

  <div
    class="tooltip-content"
    data-position="{{ position }}"
    role="tooltip"
  >
    {{ text }}
    <span class="tooltip-arrow"></span>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('[data-slot="tooltip"]').forEach((tooltip) => {
      const trigger = tooltip.querySelector(".tooltip-trigger");
      const content = tooltip.querySelector(".tooltip-content");
      let timeout;

      const showTooltip = () => {
        timeout = setTimeout(() => {
          tooltip.setAttribute("data-visible", "true");
        }, {{ delay | default: 0 }});
      };

      const hideTooltip = () => {
        clearTimeout(timeout);
        tooltip.removeAttribute("data-visible");
      };

      trigger.addEventListener("mouseenter", showTooltip);
      trigger.addEventListener("mouseleave", hideTooltip);
      trigger.addEventListener("focus", showTooltip);
      trigger.addEventListener("blur", hideTooltip);
    });
  });
</script>
