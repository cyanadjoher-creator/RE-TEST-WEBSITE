{% schema %}
{
  "name": "Contact — Departments + Form",
  "settings": [
    { "type": "text", "id": "heading_left", "label": "Titre (gauche)", "default": "CONTACTS BY DEPARTMENT" },
    { "type": "text", "id": "heading_right", "label": "Titre (droite)", "default": "SEND US A MESSAGE" }
  ],
  "blocks": [
    {
      "type": "department",
      "name": "Department",
      "settings": [
        { "type": "text", "id": "title", "label": "Titre", "default": "CUSTOMER SERVICE" },
        { "type": "text", "id": "email", "label": "Email", "default": "service@badseki.com" },
        { "type": "text", "id": "phone", "label": "Téléphone", "default": "+00 000 000 0000" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Contact — Departments + Form",
      "blocks": [
        { "type": "department", "settings": { "title": "CUSTOMER SERVICE", "email": "service@badseki.com", "phone": "+00 000 000 0000" } },
        { "type": "department", "settings": { "title": "PRESS INQUIRIES", "email": "press@badseki.com", "phone": "+00 000 000 0001" } },
        { "type": "department", "settings": { "title": "WHOLESALE", "email": "wholesale@badseki.com", "phone": "+00 000 000 0002" } },
        { "type": "department", "settings": { "title": "CAREERS", "email": "careers@badseki.com", "phone": "+00 000 000 0003" } }
      ]
    }
  ]
}
{% endschema %}

<div class="min-h-screen bg-white pt-16">
  <div class="px-6 py-12">
    <div class="grid md:grid-cols-2 gap-16">
      {%- comment -%} LEFT — Departments accordion {%- endcomment -%}
      <div>
        <h1 class="uppercase mb-8" style="font-size:24px;letter-spacing:.05em;font-weight:400">
          {{ section.settings.heading_left }}
        </h1>

        <div class="w-full" data-accordion>
          {%- for block in section.blocks -%}
            {%- if block.type == 'department' -%}
              <details class="border-b border-black/20 group" {{ block.shopify_attributes }}>
                <summary class="uppercase hover:opacity-60 transition-opacity py-4 flex items-center justify-between cursor-pointer"
                  style="font-size:14px;letter-spacing:.05em;font-weight:400">
                  <span>{{ block.settings.title | escape }}</span>
                  <span class="ml-4 transition-transform group-open:rotate-45">+</span>
                </summary>
                <div class="pb-4 space-y-2">
                  {%- if block.settings.email != blank -%}
                    <div>
                      <a href="mailto:{{ block.settings.email | escape }}"
                         class="opacity-70 hover:opacity-100 transition-opacity"
                         style="font-size:14px;letter-spacing:.02em">
                        {{ block.settings.email }}
                      </a>
                    </div>
                  {%- endif -%}
                  {%- if block.settings.phone != blank -%}
                    <div class="opacity-70" style="font-size:14px;letter-spacing:.02em">
                      {{ block.settings.phone }}
                    </div>
                  {%- endif -%}
                </div>
              </details>
            {%- endif -%}
          {%- endfor -%}
          {%- if section.blocks.size == 0 -%}
            <p class="text-sm opacity-60">Add department blocks in the section settings.</p>
          {%- endif -%}
        </div>
      </div>

      {%- comment -%} RIGHT — Shopify contact form {%- endcomment -%}
      <div>
        <h2 class="uppercase mb-8" style="font-size:24px;letter-spacing:.05em;font-weight:400">
          {{ section.settings.heading_right }}
        </h2>

        {%- form 'contact', id: 'contact-form', class: 'space-y-8' -%}
          {%- if form.posted_successfully? -%}
            <div class="p-4 border border-black/20 bg-black/5 text-sm">
              Thank you — your message has been sent.
            </div>
          {%- endif -%}

          {%- if form.errors -%}
            <div class="p-4 border border-red-400 bg-red-50 text-sm text-red-700">
              <p class="mb-2 font-medium">Please fix the following:</p>
              <ul class="list-disc pl-5">
                {%- for field in form.errors -%}
                  <li>{{ form.errors.translated_fields[field] | default: field | capitalize }} — {{ form.errors.messages[field] }}</li>
                {%- endfor -%}
              </ul>
            </div>
          {%- endif -%}

          <div>
            <input
              type="text"
              name="contact[name]"
              placeholder="NAME"
              value="{{ form.contact.name | default: customer.name | escape }}"
              class="w-full pb-2 border-b border-black/30 bg-transparent focus:outline-none focus:border-black transition-colors uppercase"
              style="font-size:14px;letter-spacing:.05em"
              required
              aria-required="true"
            />
          </div>

          <div>
            <input
              type="email"
              name="contact[email]"
              placeholder="EMAIL"
              value="{{ form.contact.email | default: customer.email | escape }}"
              class="w-full pb-2 border-b border-black/30 bg-transparent focus:outline-none focus:border-black transition-colors uppercase"
              style="font-size:14px;letter-spacing:.05em"
              required
              aria-required="true"
            />
          </div>

          <div>
            <input
              type="tel"
              name="contact[phone]"
              placeholder="PHONE"
              value="{{ form.contact.phone | escape }}"
              class="w-full pb-2 border-b border-black/30 bg-transparent focus:outline-none focus:border-black transition-colors uppercase"
              style="font-size:14px;letter-spacing:.05em"
            />
          </div>

          <div>
            <textarea
              name="contact[body]"
              placeholder="MESSAGE"
              rows="5"
              class="w-full pb-2 border-b border-black/30 bg-transparent focus:outline-none focus:border-black transition-colors uppercase resize-none"
              style="font-size:14px;letter-spacing:.05em"
              required
              aria-required="true"
            >{{ form.contact.body | escape }}</textarea>
          </div>

          <button
            type="submit"
            class="w-full bg-black text-white py-4 uppercase hover:bg-black/80 transition-colors"
            style="font-size:14px;letter-spacing:.1em;font-weight:400">
            SEND
          </button>
        {%- endform -%}
      </div>
    </div>
  </div>
</div>
